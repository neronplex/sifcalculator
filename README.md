sifcalculator
==========

[ラブライブ！スクールアイドルフェスティバル（スクフェス）](http://lovelive.bushimo.jp/)のカードをカンストさせるまでに必要な経験値を計算するプログラムです。

実行環境
----------
+  PHP 5.5以上
+  MySQL 5以上

インストレーション
----------
1. commands.sqlを参照し、経験値テーブルを用意します。
2. calculator.phpのCONFIGクラスを参照し、1で用意したデータベースの接続情報を記入します。
3. 実行ファイル群を任意のディレクトリに配置します。
 
使い方
----------
init.phpへ向けてPOSTメソッドで4つのパラメータを送信することで、必要な経験値を自動で計算し、結果がJSON形式で返却されます。
 
パラメータの解説
----------
### 送信時 ###
* `rarity` : 
_計算対象となるカードのレアリティ_を指定します。
現時点で N / R / SR / UR の4種類が存在し、_それ以外のレアリティを指定した場合はエラー_となります。
* `isplus` : 
_計算対象となるカードが覚醒済みか否かを指定_するフラグです。覚醒済の場合は`true`を、未覚醒の場合は`false`を指定してください。
* `lv` : 
_計算を開始するレベル_を数値で指定します。例えば、`lv=10`とした場合は、Lv10の時点から必要な経験値が計算されます。_1-3桁からなる半角数字のみ_を受け付け、_文字列ないしは4桁以上の数字を指定した場合はエラー_となります。また、_レベルとして`0`を指定した場合もエラー_となります。
* `next_lv_exp` : 
_次のレベルまで_を数値で指定します。例えば、`next_lv_exp=100`とした場合は、計算を開始するレベルの経験値テーブルから100を引き、その結果計算された値を、すでに加算されている経験値と見なして、計算された全体の経験値から差し引きます。_1-4桁からなる半角数字のみ_を受け付け、_文字列ないしは5桁以上の数字を指定した場合はエラー_となります。
 
### 返却時 ###
* `status` : 実行した結果がステータスコードとして返却されます。ステータスコードは、以下の3種類が返却されます。
    * `success` : 計算の実行に成功しました。`exp`に計算された経験値が返却されていますので、そちらもあわせて確認してください。 
    * `invalid` : パラメータのバリデーションを通過出来ていません。送信パラメータの見直しを行ってください。
    * `dberror` : データベースへの接続情報が誤っているなどの理由により、データベースへの接続・SQL文の送信に失敗しています。
* `exp` : 計算が成功した場合は、計算された経験値が返却されます。何らかの理由によってエラーとなった場合は`null`が返却されます。
 
謝辞
----------
* 経験値テーブルの数値は以下を参考にさせて頂きました。
    * [ラブライブ！スクフェス 情報まとめwiki - 経験値テーブル](http://www59.atwiki.jp/lovelive-sif/pages/32.html)
 
ライセンス
----------
Copyright &copy; 2014 暖簾 ([@neronplex](http://www.twitter.com/neronplex))
Licensed under the [Apache License, Version 2.0][Apache]
 [Apache]: http://www.apache.org/licenses/LICENSE-2.0
